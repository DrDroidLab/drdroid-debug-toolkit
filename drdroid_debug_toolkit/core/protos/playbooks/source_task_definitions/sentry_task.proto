syntax = "proto3";
package core.protos.playbooks;

import "google/protobuf/wrappers.proto";

message Sentry {
  message FetchIssueInfoById {
    google.protobuf.StringValue issue_id = 1;
  }

  message FetchProjectEvents {
    google.protobuf.StringValue project_slug = 1;
  }

  message FetchRecentErrors {
    google.protobuf.StringValue project_slug = 1;
  }

  message FetchEventInfoById {
    google.protobuf.StringValue event_id = 1;
    google.protobuf.StringValue project_slug = 2;
  }

  message FetchListOfRecentEventsWithSearchQuery{
    google.protobuf.StringValue project_slug = 1;
    google.protobuf.StringValue query = 2;
    google.protobuf.Int64Value max_events_to_analyse = 3;
  }

  message QueryIssues {
    google.protobuf.StringValue project_slug = 1;
    google.protobuf.StringValue query = 2;  // Optional query string (e.g., "is:unresolved level:error")
    google.protobuf.StringValue stats_period = 3;  // Optional stats period (e.g., "24h", "14d")
    google.protobuf.Int64Value limit = 4;  // Optional limit on total number of issues to return (pagination continues until limit is reached)
  }

  message FetchProjects {}

  enum TaskType {
    UNKNOWN = 0;
    FETCH_ISSUE_INFO_BY_ID = 1;
    FETCH_PROJECT_EVENTS = 2;
    FETCH_RECENT_ERRORS = 3;
    FETCH_EVENT_INFO_BY_ID = 4;
    FETCH_LIST_OF_RECENT_EVENTS_WITH_SEARCH_QUERY = 5;
    FETCH_PROJECTS = 6;
    QUERY_ISSUES = 7;
  }

  TaskType type = 1;
  oneof task {
    FetchIssueInfoById fetch_issue_info_by_id = 2;
    FetchProjectEvents fetch_project_events = 3;
    FetchRecentErrors fetch_recent_errors = 4;
    FetchEventInfoById fetch_event_info_by_id = 5;
    FetchListOfRecentEventsWithSearchQuery fetch_list_of_recent_events_with_search_query = 6;
    FetchProjects fetch_projects = 7;
    QueryIssues query_issues = 8;
  }
}